{"version":3,"file":"useDialogDrag.js","sources":["../../../../components/dialog/hooks/useDialogDrag.ts"],"sourcesContent":["import { useRef } from 'react';\nimport useMouseEvent from '../../hooks/useMouseEvent';\n\ninterface DialogDragProps {\n  dialogCardRef: React.MutableRefObject<HTMLDivElement | null>;\n  canDraggable?: boolean;\n}\n\nconst useDialogDrag = (props: DialogDragProps) => {\n  const { dialogCardRef, canDraggable } = props;\n\n  const validWindow = typeof window === 'object';\n  const screenHeight = validWindow ? window.innerHeight || document.documentElement.clientHeight : undefined;\n  const screenWidth = validWindow ? window.innerWidth || document.documentElement.clientWidth : undefined;\n\n  const dragOffset = useRef({ x: 0, y: 0 });\n\n  useMouseEvent(dialogCardRef, {\n    enabled: canDraggable,\n    onDown: (e) => {\n      const { offsetLeft, offsetTop, offsetWidth, offsetHeight, style } = dialogCardRef.current;\n      if (offsetWidth > screenWidth || offsetHeight > screenHeight) return;\n      style.cursor = 'move';\n      dragOffset.current = {\n        x: e.clientX - offsetLeft,\n        y: e.clientY - offsetTop,\n      };\n    },\n    onMove: (e) => {\n      const { offsetWidth, offsetHeight, style } = dialogCardRef.current;\n      let diffX = e.clientX - dragOffset.current.x;\n      let diffY = e.clientY - dragOffset.current.y;\n      // 拖拽上左边界限制\n      if (diffX < 0) diffX = 0;\n      if (diffY < 0) diffY = 0;\n      if (screenWidth - offsetWidth - diffX < 0) diffX = screenWidth - offsetWidth;\n      if (screenHeight - offsetHeight - diffY < 0) diffY = screenHeight - offsetHeight;\n      style.position = 'absolute';\n      style.left = `${diffX}px`;\n      style.top = `${diffY}px`;\n    },\n    onUp: () => {\n      dialogCardRef.current.style.cursor = 'default';\n    },\n  });\n};\n\nexport default useDialogDrag;\n"],"names":["useDialogDrag","props","dialogCardRef","canDraggable","validWindow","window","_typeof","screenHeight","innerHeight","document","documentElement","clientHeight","screenWidth","innerWidth","clientWidth","dragOffset","useRef","x","y","useMouseEvent","enabled","onDown","e","_dialogCardRef$curren","current","offsetLeft","offsetTop","offsetWidth","offsetHeight","style","cursor","clientX","clientY","onMove","_dialogCardRef$curren2","diffX","diffY","position","left","top","onUp"],"mappings":"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"}