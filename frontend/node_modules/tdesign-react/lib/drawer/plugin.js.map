{"version":3,"file":"plugin.js","sources":["../../../components/drawer/plugin.tsx"],"sourcesContent":["import React from 'react';\nimport log from '@tdesign/common-js/log/index';\nimport { render } from '../_util/react-render';\nimport DrawerComponent, { DrawerProps } from './Drawer';\n\nimport { getAttach } from '../_util/dom';\nimport type { DrawerOptions, DrawerMethod, DrawerInstance } from './type';\nimport ConfigProvider from '../config-provider';\nimport PluginContainer from '../common/PluginContainer';\n\nconst createDrawer: DrawerMethod = (props: DrawerOptions): DrawerInstance => {\n  const drawerRef = React.createRef<DrawerInstance>();\n\n  // 默认先不打开。如有更好的方法，请代替↓\n  const { visible = false } = props;\n\n  const fragment = document.createDocumentFragment();\n\n  const dGlobalConfig = ConfigProvider.getGlobalConfig();\n  render(<PluginContainer globalConfig={dGlobalConfig}><DrawerComponent {...(props as DrawerProps)} visible={visible} ref={drawerRef} isPlugin /></PluginContainer>, fragment);\n\n  const container = getAttach(props.attach);\n  if (container) {\n    // 加载出来了再设置打开，打开才有动画。如有更好的方法，请代替↓\n    requestAnimationFrame(() => {\n      drawerRef.current?.show();\n    });\n    container.appendChild(fragment);\n  } else {\n    log.error('Drawer', 'attach is not exist');\n  }\n\n  const drawerNode: DrawerInstance = {\n    show: () => {\n      requestAnimationFrame(() => {\n        drawerRef.current?.show();\n      });\n    },\n    hide: () => {\n      requestAnimationFrame(() => {\n        drawerRef.current?.destroy();\n      });\n    },\n    update: (updateOptions: DrawerOptions) => {\n      requestAnimationFrame(() => {\n        drawerRef.current?.update(updateOptions);\n      });\n    },\n    destroy: () => {\n      requestAnimationFrame(() => {\n        drawerRef.current?.destroy();\n      });\n    },\n  };\n  return drawerNode;\n};\n\nexport const DrawerPlugin = createDrawer;\n"],"names":["createDrawer","props","drawerRef","React","createRef","_props$visible","visible","fragment","document","createDocumentFragment","dGlobalConfig","ConfigProvider","getGlobalConfig","render","createElement","PluginContainer","globalConfig","DrawerComponent","_objectSpread","ref","isPlugin","container","getAttach","attach","requestAnimationFrame","_drawerRef$current","current","show","appendChild","log","error","drawerNode","_drawerRef$current2","hide","_drawerRef$current3","destroy","update","updateOptions","_drawerRef$current4","_drawerRef$current5","DrawerPlugin"],"mappings":"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"}