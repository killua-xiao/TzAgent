{"version":3,"file":"useRotate.js","sources":["../../../../components/image-viewer/hooks/useRotate.ts"],"sourcesContent":["// 旋转控制\nimport { useCallback, useRef, useState } from 'react';\n\nconst useRotate = () => {\n  // There is an useEffect in the line 472 of ImageViewerModal.tsx, so we need to use a ref to store the rotateZ value.\n  const rotRef = useRef(0);\n  const [rotateZ, setRotateZ] = useState(0);\n\n  const onRotate = useCallback((ROTATE_COUNT: number) => {\n    setRotateZ((rotateZ) => {\n      rotRef.current = rotateZ + ROTATE_COUNT;\n      return rotateZ + ROTATE_COUNT;\n    });\n  }, []);\n\n  const onResetRotate = useCallback(() => {\n    let degreeToRotate = rotRef.current % 360;\n    // make sure we always rotate to the shortest direction\n    if (Math.abs(degreeToRotate) > 180) {\n      degreeToRotate = (degreeToRotate + 360) % 360;\n    }\n    if (degreeToRotate !== 0) {\n      setRotateZ((rotateZ) => {\n        rotRef.current = rotateZ - degreeToRotate;\n        return rotateZ - degreeToRotate;\n      });\n    }\n  }, []);\n\n  return {\n    rotateZ,\n    onResetRotate,\n    onRotate,\n  };\n};\n\nexport default useRotate;\n"],"names":["useRotate","rotRef","useRef","_useState","useState","_useState2","_slicedToArray","rotateZ","setRotateZ","onRotate","useCallback","ROTATE_COUNT","current","onResetRotate","degreeToRotate","Math","abs"],"mappings":";;;;;;;;;;AAGA,IAAMA,YAAY,SAAZA,YAAkB;AAEhB,EAAA,IAAAC,MAAA,GAASC,OAAO,CAAC,CAAA,CAAA;AACvB,EAAA,IAAAC,SAAA,GAA8BC,SAAS,CAAC,CAAA;IAAAC,UAAA,GAAAC,cAAA,CAAAH,SAAA,EAAA,CAAA,CAAA;AAAjCI,IAAAA,OAAA,GAAAF,UAAA,CAAA,CAAA,CAAA;AAASG,IAAAA,UAAU,GAAAH,UAAA,CAAA,CAAA,CAAA,CAAA;AAEpB,EAAA,IAAAI,QAAA,GAAWC,WAAY,CAAA,UAACC,YAAyB,EAAA;IACrDH,UAAA,CAAW,UAACD,QAAY,EAAA;AACtBN,MAAAA,MAAA,CAAOW,UAAUL,QAAU,GAAAI,YAAA,CAAA;MAC3B,OAAOJ,QAAU,GAAAI,YAAA,CAAA;AACnB,KAAC,CAAA,CAAA;GACH,EAAG,EAAE,CAAA,CAAA;AAEC,EAAA,IAAAE,aAAA,GAAgBH,YAAY,YAAM;AAClC,IAAA,IAAAI,cAAA,GAAiBb,OAAOW,OAAU,GAAA,GAAA,CAAA;IAEtC,IAAIG,IAAK,CAAAC,GAAA,CAAIF,cAAc,CAAA,GAAI,GAAK,EAAA;AAClCA,MAAAA,cAAA,GAAA,CAAkBA,iBAAiB,GAAO,IAAA,GAAA,CAAA;AAC5C,KAAA;IACA,IAAIA,mBAAmB,CAAG,EAAA;MACxBN,UAAA,CAAW,UAACD,QAAY,EAAA;AACtBN,QAAAA,MAAA,CAAOW,UAAUL,QAAU,GAAAO,cAAA,CAAA;QAC3B,OAAOP,QAAU,GAAAO,cAAA,CAAA;AACnB,OAAC,CAAA,CAAA;AACH,KAAA;GACF,EAAG,EAAE,CAAA,CAAA;EAEE,OAAA;AACLP,IAAAA,OAAA,EAAAA,OAAA;AACAM,IAAAA,aAAA,EAAAA,aAAA;AACAJ,IAAAA,QAAA,EAAAA,QAAAA;GACF,CAAA;AACF;;;;"}