{"version":3,"file":"useAffix.js","sources":["../../../../components/table/hooks/useAffix.ts"],"sourcesContent":["import { useState, useRef, useMemo, useEffect } from 'react';\nimport { TdBaseTableProps } from '../type';\nimport { AffixProps } from '../../affix';\nimport { off, on } from '../../_util/listener';\n\n/**\n * 1. 表头吸顶（普通表头吸顶 和 虚拟滚动表头吸顶）\n * 2. 表尾吸底\n * 3. 底部滚动条吸底\n * 4. 分页器吸底\n */\nexport default function useAffix(props: TdBaseTableProps, { showElement }: { showElement: boolean }) {\n  const tableContentRef = useRef<HTMLDivElement>(null);\n  // 吸顶表头\n  const affixHeaderRef = useRef<HTMLDivElement>(null);\n  // 吸底表尾\n  const affixFooterRef = useRef<HTMLDivElement>(null);\n  // 吸底滚动条\n  const horizontalScrollbarRef = useRef<HTMLDivElement>(null);\n  // 吸底分页器\n  const paginationRef = useRef<HTMLDivElement>(null);\n  // 当表格完全滚动消失在视野时，需要隐藏吸顶表头\n  const [showAffixHeader, setShowAffixHeader] = useState(true);\n  // 当表格完全滚动消失在视野时，需要隐藏吸底尾部\n  const [showAffixFooter, setShowAffixFooter] = useState(true);\n  // 当表格完全滚动消失在视野时，需要隐藏吸底分页器\n  const [showAffixPagination, setShowAffixPagination] = useState(true);\n\n  const isVirtualScroll = useMemo(\n    () => props.scroll && props.scroll.type === 'virtual' && (props.scroll.threshold || 100) < props.data.length,\n    [props.data.length, props.scroll],\n  );\n\n  const isAffixed = useMemo(\n    () => !!(props.headerAffixedTop || props.footerAffixedBottom || props.horizontalScrollAffixedBottom),\n    [props.footerAffixedBottom, props.headerAffixedTop, props.horizontalScrollAffixedBottom],\n  );\n\n  let lastScrollLeft = 0;\n  const onHorizontalScroll = (scrollElement?: HTMLElement) => {\n    if (!isAffixed && !isVirtualScroll) return;\n    let target = scrollElement;\n    if (!target && tableContentRef.current) {\n      lastScrollLeft = 0;\n      target = tableContentRef.current;\n    }\n    if (!target) return;\n    const left = target.scrollLeft;\n    // 如果 lastScrollLeft 等于 left，说明不是横向滚动，不需要更新横向滚动距离\n    if (lastScrollLeft === left) return;\n    lastScrollLeft = left;\n    // 表格内容、吸顶表头、吸底表尾、吸底横向滚动更新\n    const toUpdateScrollElement = [\n      tableContentRef.current,\n      affixHeaderRef.current,\n      affixFooterRef.current,\n      horizontalScrollbarRef.current,\n    ];\n    for (let i = 0, len = toUpdateScrollElement.length; i < len; i++) {\n      if (toUpdateScrollElement[i] && scrollElement !== toUpdateScrollElement[i]) {\n        toUpdateScrollElement[i].scrollLeft = left;\n      }\n    }\n  };\n\n  // 吸底的元素（footer、横向滚动条、分页器）是否显示\n  const isAffixedBottomElementShow = (elementRect: DOMRect, tableRect: DOMRect, headerHeight: number) =>\n    tableRect.top + headerHeight < elementRect.top && elementRect.top > elementRect.height;\n\n  const getOffsetTop = (props: boolean | Partial<AffixProps>) => {\n    if (typeof props === 'boolean') return 0;\n    return props.offsetTop || 0;\n  };\n\n  const updateAffixHeaderOrFooter = () => {\n    if (!isAffixed && !isVirtualScroll) return;\n    const pos = tableContentRef.current?.getBoundingClientRect();\n    if (!pos) return;\n    const headerRect = tableContentRef.current?.querySelector('thead')?.getBoundingClientRect();\n    const headerHeight = headerRect?.height || 0;\n    const footerRect = affixFooterRef.current?.getBoundingClientRect();\n    if ((props.headerAffixedTop || isVirtualScroll) && affixHeaderRef.current) {\n      const offsetTop = getOffsetTop(props.headerAffixProps || props.headerAffixedTop);\n      const footerHeight = footerRect?.height || 0;\n      let r = Math.abs(pos.top) < pos.height - headerHeight - offsetTop - footerHeight;\n      // 如果是虚拟滚动的表头，只要表头在可视区域内，一律永久显示（虚拟滚动表头 和 吸顶表头可能同时存在）\n      if (isVirtualScroll) {\n        r = pos.top > -1 * headerRect.height;\n      }\n      setShowAffixHeader(r);\n    }\n    // 底部内容吸底 和 底部滚动条吸底，不可能同时存在，二选一即可\n    if (props.footerAffixedBottom && affixFooterRef.current) {\n      const show = isAffixedBottomElementShow(footerRect, pos, headerHeight);\n      setShowAffixFooter(show);\n    } else if (props.horizontalScrollAffixedBottom && horizontalScrollbarRef.current) {\n      const horizontalScrollbarRect = horizontalScrollbarRef.current.getBoundingClientRect();\n      const show = isAffixedBottomElementShow(horizontalScrollbarRect, pos, headerHeight);\n      setShowAffixFooter(show);\n    }\n    if (props.paginationAffixedBottom && paginationRef.current) {\n      const pageRect = paginationRef.current.getBoundingClientRect();\n      const show = isAffixedBottomElementShow(pageRect, pos, headerHeight);\n      setShowAffixPagination(show);\n    }\n  };\n\n  const onDocumentScroll = () => {\n    updateAffixHeaderOrFooter();\n  };\n\n  const onFootScroll = () => {\n    onHorizontalScroll(affixFooterRef.current);\n  };\n\n  const onHeaderScroll = () => {\n    onHorizontalScroll(affixHeaderRef.current);\n  };\n\n  const horizontalScrollbarScroll = () => {\n    onHorizontalScroll(horizontalScrollbarRef.current);\n  };\n\n  const onTableContentScroll = () => {\n    onHorizontalScroll(tableContentRef.current);\n  };\n\n  const onFootMouseEnter = () => {\n    on(affixFooterRef.current, 'scroll', onFootScroll);\n  };\n\n  const onFootMouseLeave = () => {\n    off(affixFooterRef.current, 'scroll', onFootScroll);\n  };\n\n  const onHeaderMouseEnter = () => {\n    on(affixHeaderRef.current, 'scroll', onHeaderScroll);\n  };\n\n  const onHeaderMouseLeave = () => {\n    off(affixHeaderRef.current, 'scroll', onHeaderScroll);\n  };\n\n  const onScrollbarMouseEnter = () => {\n    on(horizontalScrollbarRef.current, 'scroll', horizontalScrollbarScroll);\n  };\n\n  const onScrollbarMouseLeave = () => {\n    off(horizontalScrollbarRef.current, 'scroll', horizontalScrollbarScroll);\n  };\n\n  const onTableContentMouseEnter = () => {\n    on(tableContentRef.current, 'scroll', onTableContentScroll);\n  };\n\n  const onTableContentMouseLeave = () => {\n    off(tableContentRef.current, 'scroll', onTableContentScroll);\n  };\n\n  const addHorizontalScrollListeners = () => {\n    if (affixHeaderRef.current) {\n      on(affixHeaderRef.current, 'mouseenter', onHeaderMouseEnter);\n      on(affixHeaderRef.current, 'mouseleave', onHeaderMouseLeave);\n    }\n\n    if (props.footerAffixedBottom && affixFooterRef.current) {\n      on(affixFooterRef.current, 'mouseenter', onFootMouseEnter);\n      on(affixFooterRef.current, 'mouseleave', onFootMouseLeave);\n    }\n\n    if (props.horizontalScrollAffixedBottom && horizontalScrollbarRef.current) {\n      on(horizontalScrollbarRef.current, 'mouseenter', onScrollbarMouseEnter);\n      on(horizontalScrollbarRef.current, 'mouseleave', onScrollbarMouseLeave);\n    }\n\n    if ((isAffixed || isVirtualScroll) && tableContentRef.current) {\n      on(tableContentRef.current, 'mouseenter', onTableContentMouseEnter);\n      on(tableContentRef.current, 'mouseleave', onTableContentMouseLeave);\n    }\n  };\n\n  const removeHorizontalScrollListeners = () => {\n    if (affixHeaderRef.current) {\n      off(affixHeaderRef.current, 'mouseenter', onHeaderMouseEnter);\n      off(affixHeaderRef.current, 'mouseleave', onHeaderMouseLeave);\n    }\n    if (affixFooterRef.current) {\n      off(affixFooterRef.current, 'mouseenter', onFootMouseEnter);\n      off(affixFooterRef.current, 'mouseleave', onFootMouseLeave);\n    }\n    if (tableContentRef.current) {\n      off(tableContentRef.current, 'mouseenter', onTableContentMouseEnter);\n      off(tableContentRef.current, 'mouseleave', onTableContentMouseLeave);\n    }\n    if (horizontalScrollbarRef.current) {\n      off(horizontalScrollbarRef.current, 'mouseenter', onScrollbarMouseEnter);\n      off(horizontalScrollbarRef.current, 'mouseleave', onScrollbarMouseLeave);\n    }\n  };\n\n  const addVerticalScrollListener = () => {\n    if (typeof document === 'undefined') return;\n    if (!isAffixed && !props.paginationAffixedBottom) return;\n    const timer = setTimeout(() => {\n      if (isAffixed || props.paginationAffixedBottom) {\n        on(document, 'scroll', onDocumentScroll);\n      } else {\n        off(document, 'scroll', onDocumentScroll);\n      }\n      clearTimeout(timer);\n    });\n  };\n\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      addHorizontalScrollListeners();\n      onHorizontalScroll();\n      updateAffixHeaderOrFooter();\n      clearTimeout(timer);\n    });\n\n    return removeHorizontalScrollListeners;\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [affixHeaderRef, affixFooterRef, horizontalScrollbarRef, tableContentRef, showElement]);\n\n  useEffect(() => {\n    addVerticalScrollListener();\n    return () => {\n      off(document, 'scroll', onDocumentScroll);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isAffixed]);\n\n  useEffect(() => {\n    addHorizontalScrollListeners();\n    onHorizontalScroll();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [\n    props.data,\n    props.columns,\n    props.headerAffixedTop,\n    props.footerAffixedBottom,\n    props.horizontalScrollAffixedBottom,\n    props.lazyLoad,\n  ]);\n\n  const setTableContentRef = (tableContent: HTMLDivElement) => {\n    tableContentRef.current = tableContent;\n    addVerticalScrollListener();\n  };\n\n  return {\n    showAffixHeader,\n    showAffixFooter,\n    showAffixPagination,\n    affixHeaderRef,\n    affixFooterRef,\n    horizontalScrollbarRef,\n    paginationRef,\n    onHorizontalScroll,\n    setTableContentRef,\n    updateAffixHeaderOrFooter,\n  };\n}\n"],"names":["useAffix","props","_ref","showElement","tableContentRef","useRef","affixHeaderRef","affixFooterRef","horizontalScrollbarRef","paginationRef","_useState","useState","_useState2","_slicedToArray","showAffixHeader","setShowAffixHeader","_useState3","_useState4","showAffixFooter","setShowAffixFooter","_useState5","_useState6","showAffixPagination","setShowAffixPagination","isVirtualScroll","useMemo","scroll","type","threshold","data","length","isAffixed","headerAffixedTop","footerAffixedBottom","horizontalScrollAffixedBottom","lastScrollLeft","onHorizontalScroll","scrollElement","target","current","left","scrollLeft","toUpdateScrollElement","i","len","isAffixedBottomElementShow","elementRect","tableRect","headerHeight","top","height","getOffsetTop","offsetTop","updateAffixHeaderOrFooter","_tableContentRef$curr","_tableContentRef$curr2","_affixFooterRef$curre","pos","getBoundingClientRect","headerRect","querySelector","footerRect","headerAffixProps","footerHeight","r","Math","abs","show","horizontalScrollbarRect","paginationAffixedBottom","pageRect","onDocumentScroll","onFootScroll","onHeaderScroll","horizontalScrollbarScroll","onTableContentScroll","onFootMouseEnter","on","onFootMouseLeave","off","onHeaderMouseEnter","onHeaderMouseLeave","onScrollbarMouseEnter","onScrollbarMouseLeave","onTableContentMouseEnter","onTableContentMouseLeave","addHorizontalScrollListeners","removeHorizontalScrollListeners","addVerticalScrollListener","document","timer","setTimeout","clearTimeout","useEffect","columns","lazyLoad","setTableContentRef","tableContent"],"mappings":"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"}