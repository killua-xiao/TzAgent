{"version":3,"file":"useClickOutside.js","sources":["../../../components/hooks/useClickOutside.ts"],"sourcesContent":["import { MutableRefObject, useEffect } from 'react';\nimport useConfig from './useConfig';\n\nexport default function useClickOutside<T extends HTMLElement>(\n  refs: MutableRefObject<T>[],\n  handler: (event: MouseEvent | TouchEvent) => void,\n  includePopup?: boolean,\n) {\n  const { classPrefix } = useConfig();\n  const POPUP_SELECTOR = `.${classPrefix}-popup`;\n\n  useEffect(() => {\n    const listener = (event) => {\n      if (!Array.isArray(refs)) {\n        return;\n      }\n\n      let elements = [];\n      if (includePopup) {\n        document.querySelectorAll(POPUP_SELECTOR).forEach((ele: Element) => {\n          elements.push(ele as HTMLElement);\n        });\n      }\n      elements = Array.from(new Set(elements));\n\n      // Do nothing if clicking ref's element or descendent elements\n      if (\n        refs.find((ref) => ref.current?.contains(event.target)) ||\n        elements.find((el) => el?.contains(event.target))\n      ) {\n        return;\n      }\n      handler(event);\n    };\n    // todo: pointerdown， jsdom 暂未实现 pointer 事件，后续加上后可以改进.\n    document.addEventListener('mousedown', listener);\n    document.addEventListener('touchstart', listener);\n    return () => {\n      document.removeEventListener('mousedown', listener);\n      document.removeEventListener('touchstart', listener);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [refs, handler, includePopup]);\n}\n"],"names":["useClickOutside","refs","handler","includePopup","_useConfig","useConfig","classPrefix","POPUP_SELECTOR","useEffect","listener","event","Array","isArray","elements","document","querySelectorAll","forEach","ele","push","from","Set","find","ref","_ref$current","current","contains","target","el","addEventListener","removeEventListener"],"mappings":";;;;;;;;;;;;;;;;;AAGwB,SAAAA,eAAAA,CACtBC,IACA,EAAAC,OAAA,EACAC,YACA,EAAA;AACM,EAAA,IAAAC,UAAA,GAAkBC,SAAU,EAAA;IAA1BC,WAAY,GAAAF,UAAA,CAAZE,WAAY,CAAA;AACpB,EAAA,IAAMC,4BAAqBD,WAAA,EAAA,QAAA,CAAA,CAAA;AAE3BE,EAAAA,SAAA,CAAU,YAAM;AACR,IAAA,IAAAC,QAAA,GAAW,SAAXA,QAAAA,CAAYC,KAAU,EAAA;AAC1B,MAAA,IAAI,CAACC,KAAA,CAAMC,OAAQ,CAAAX,IAAI,CAAG,EAAA;AACxB,QAAA,OAAA;AACF,OAAA;MAEA,IAAIY,WAAW,EAAC,CAAA;AAChB,MAAA,IAAIV,YAAc,EAAA;QAChBW,QAAA,CAASC,gBAAiB,CAAAR,cAAc,CAAE,CAAAS,OAAA,CAAQ,UAACC,GAAiB,EAAA;AAClEJ,UAAAA,QAAA,CAASK,KAAKD,GAAkB,CAAA,CAAA;AAClC,SAAC,CAAA,CAAA;AACH,OAAA;MACAJ,QAAA,GAAWF,KAAM,CAAAQ,IAAA,CAAK,IAAIC,GAAA,CAAIP,QAAQ,CAAC,CAAA,CAAA;AAIrC,MAAA,IAAAZ,IAAA,CAAKoB,KAAK,UAACC,GAAA,EAAA;AAAA,QAAA,IAAAC,YAAA,CAAA;AAAA,QAAA,OAAA,CAAAA,YAAA,GAAQD,IAAIE,OAAS,MAAAD,IAAAA,IAAAA,YAAA,KAAbA,KAAAA,CAAAA,GAAAA,KAAAA,CAAAA,GAAAA,YAAA,CAAaE,QAAA,CAASf,MAAMgB,MAAM,CAAC,CAAA;AAAA,OAAA,KACtDb,QAAS,CAAAQ,IAAA,CAAK,UAACM,EAAO,EAAA;QAAA,OAAAA,EAAA,KAAAA,IAAAA,IAAAA,EAAA,KAAAA,KAAAA,CAAAA,GAAAA,KAAAA,CAAAA,GAAAA,EAAA,CAAIF,SAASf,KAAM,CAAAgB,MAAM,CAAC,CAAA;AAAA,OAAA,CAChD,EAAA;AACA,QAAA,OAAA;AACF,OAAA;MACAxB,OAAA,CAAQQ,KAAK,CAAA,CAAA;KACf,CAAA;AAESI,IAAAA,QAAA,CAAAc,gBAAA,CAAiB,aAAanB,QAAQ,CAAA,CAAA;AACtCK,IAAAA,QAAA,CAAAc,gBAAA,CAAiB,cAAcnB,QAAQ,CAAA,CAAA;AAChD,IAAA,OAAO,YAAM;AACFK,MAAAA,QAAA,CAAAe,mBAAA,CAAoB,aAAapB,QAAQ,CAAA,CAAA;AACzCK,MAAAA,QAAA,CAAAe,mBAAA,CAAoB,cAAcpB,QAAQ,CAAA,CAAA;KACrD,CAAA;GAEC,EAAA,CAACR,IAAM,EAAAC,OAAA,EAASC,YAAY,CAAC,CAAA,CAAA;AAClC;;;;"}