{"version":3,"file":"useDrag.js","sources":["../../../../components/upload/hooks/useDrag.ts"],"sourcesContent":["import { DragEventHandler, useState } from 'react';\nimport { getFileList } from '@tdesign/common-js/upload/utils';\nimport { TdUploadProps } from '../type';\n\nexport interface UploadDragEvents {\n  accept?: string;\n  onDragFileChange?: (files: File[]) => void;\n  onDragenter?: TdUploadProps['onDragenter'];\n  onDragleave?: TdUploadProps['onDragleave'];\n  onDrop?: TdUploadProps['onDrop'];\n}\n\nexport default function useDrag(props: UploadDragEvents) {\n  const { accept } = props;\n  const [target, setTarget] = useState(null);\n  const [dragActive, setDragActive] = useState(false);\n\n  const handleDrop: DragEventHandler<HTMLDivElement> = (event) => {\n    event.preventDefault();\n    setDragActive(false);\n\n    const { files } = event.dataTransfer;\n    const dragFiles: File[] = getFileList(files, accept);\n\n    if (dragFiles.length) {\n      props.onDragFileChange?.(dragFiles);\n    }\n    props.onDrop?.({ e: event });\n  };\n\n  const handleDragenter: DragEventHandler<HTMLDivElement> = (event) => {\n    event.preventDefault();\n    setTarget(event.target);\n    props.onDragenter?.({ e: event });\n    setDragActive(true);\n  };\n\n  const handleDragleave: DragEventHandler<HTMLDivElement> = (event) => {\n    if (event.target !== target) return;\n    event.preventDefault();\n    props.onDragleave?.({ e: event });\n    setDragActive(false);\n  };\n\n  const handleDragover: DragEventHandler<HTMLDivElement> = (event) => {\n    event.preventDefault();\n  };\n\n  return {\n    target,\n    dragActive,\n    handleDrop,\n    handleDragenter,\n    handleDragleave,\n    handleDragover,\n  };\n}\n"],"names":["useDrag","props","accept","_useState","useState","_useState2","_slicedToArray","target","setTarget","_useState3","_useState4","dragActive","setDragActive","handleDrop","event","_props$onDrop","preventDefault","files","dataTransfer","dragFiles","getFileList","length","_props$onDragFileChan","onDragFileChange","call","onDrop","e","handleDragenter","_props$onDragenter","onDragenter","handleDragleave","_props$onDragleave","onDragleave","handleDragover"],"mappings":"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"}