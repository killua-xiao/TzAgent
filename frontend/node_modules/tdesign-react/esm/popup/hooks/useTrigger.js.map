{"version":3,"file":"useTrigger.js","sources":["../../../../components/popup/hooks/useTrigger.tsx"],"sourcesContent":["import React, { useRef, useEffect, isValidElement, useCallback, useMemo } from 'react';\nimport { isFragment } from 'react-is';\nimport classNames from 'classnames';\nimport { supportRef, getRefDom, getNodeRef } from '../../_util/ref';\nimport composeRefs from '../../_util/composeRefs';\nimport { off, on } from '../../_util/listener';\n\nconst ESC_KEY = 'Escape';\n\nexport default function useTrigger({ content, disabled, trigger, visible, onVisibleChange, triggerRef, delay }) {\n  const hasPopupMouseDown = useRef(false);\n  const mouseDownTimer = useRef(0);\n  const visibleTimer = useRef(null);\n  const triggerDataKey = useRef(`t-popup--${Math.random().toFixed(10)}`);\n  const leaveFlag = useRef(false); // 防止多次触发显隐\n\n  // 禁用和无内容时不展示\n  const shouldToggle = useMemo(() => {\n    if (disabled) return false; // 禁用\n    return !disabled && content === 0 ? true : content; // 无内容时\n  }, [disabled, content]);\n\n  // 解析 delay 数据类型\n  const [appearDelay = 0, exitDelay = 0] = useMemo(() => {\n    if (Array.isArray(delay)) return delay;\n    return [delay, delay];\n  }, [delay]);\n\n  function callFuncWithDelay({ delay, callback }: { delay?: number; callback: Function }) {\n    clearTimeout(visibleTimer.current);\n    if (delay) {\n      visibleTimer.current = setTimeout(callback, delay);\n    } else {\n      callback();\n    }\n  }\n\n  // 点击 trigger overlay 以外的元素关闭\n  useEffect(() => {\n    if (!shouldToggle) return;\n\n    const handleDocumentClick = (e: any) => {\n      if (getRefDom(triggerRef)?.contains?.(e.target) || hasPopupMouseDown.current) {\n        return;\n      }\n      visible && onVisibleChange(false, { e, trigger: 'document' });\n    };\n    on(document, 'mousedown', handleDocumentClick);\n    on(document, 'touchend', handleDocumentClick);\n    return () => {\n      off(document, 'mousedown', handleDocumentClick);\n      off(document, 'touchend', handleDocumentClick);\n    };\n  }, [shouldToggle, visible, onVisibleChange, triggerRef]);\n\n  // 弹出内容交互处理\n  function getPopupProps(): any {\n    if (!shouldToggle) return {};\n\n    return {\n      onMouseEnter: (e: MouseEvent) => {\n        if (trigger === 'hover' && !leaveFlag.current) {\n          clearTimeout(visibleTimer.current);\n          onVisibleChange(true, { e, trigger: 'trigger-element-hover' });\n        }\n      },\n      onMouseLeave: (e: MouseEvent) => {\n        if (trigger === 'hover') {\n          leaveFlag.current = true;\n          clearTimeout(visibleTimer.current);\n          onVisibleChange(false, { e, trigger: 'trigger-element-hover' });\n        }\n      },\n      onMouseDown: () => {\n        clearTimeout(mouseDownTimer.current);\n        hasPopupMouseDown.current = true;\n        mouseDownTimer.current = window.setTimeout(() => {\n          hasPopupMouseDown.current = false;\n        });\n      },\n      onTouchEnd: () => {\n        clearTimeout(mouseDownTimer.current);\n        hasPopupMouseDown.current = true;\n        mouseDownTimer.current = window.setTimeout(() => {\n          hasPopupMouseDown.current = false;\n        });\n      },\n    };\n  }\n\n  // 整理 trigger props\n  function getTriggerProps(triggerNode: React.ReactElement<any>) {\n    if (!shouldToggle) return {};\n\n    const triggerProps: any = {\n      className: visible ? classNames(triggerNode.props.className, `t-popup-open`) : triggerNode.props.className,\n      onMouseDown: (e: MouseEvent) => {\n        if (trigger === 'mousedown') {\n          callFuncWithDelay({\n            delay: visible ? appearDelay : exitDelay,\n            callback: () => onVisibleChange(!visible, { e, trigger: 'trigger-element-mousedown' }),\n          });\n        }\n        triggerNode.props.onMouseDown?.(e);\n      },\n      onClick: (e: MouseEvent) => {\n        if (trigger === 'click') {\n          callFuncWithDelay({\n            delay: visible ? appearDelay : exitDelay,\n            callback: () => onVisibleChange(!visible, { e, trigger: 'trigger-element-click' }),\n          });\n        }\n        triggerNode.props.onClick?.(e);\n      },\n      onTouchStart: (e: TouchEvent) => {\n        if (trigger === 'hover' || trigger === 'mousedown') {\n          leaveFlag.current = false;\n          callFuncWithDelay({\n            delay: appearDelay,\n            callback: () => onVisibleChange(true, { e, trigger: 'trigger-element-hover' }),\n          });\n        }\n        triggerNode.props.onTouchStart?.(e);\n      },\n      onMouseEnter: (e: MouseEvent) => {\n        if (trigger === 'hover') {\n          leaveFlag.current = false;\n          callFuncWithDelay({\n            delay: appearDelay,\n            callback: () => onVisibleChange(true, { e, trigger: 'trigger-element-hover' }),\n          });\n        }\n        triggerNode.props.onMouseEnter?.(e);\n      },\n      onMouseLeave: (e: MouseEvent) => {\n        if (trigger === 'hover') {\n          leaveFlag.current = false;\n          callFuncWithDelay({\n            delay: exitDelay,\n            callback: () => onVisibleChange(false, { e, trigger: 'trigger-element-hover' }),\n          });\n        }\n        triggerNode.props.onMouseLeave?.(e);\n      },\n      onFocus: (...args: any) => {\n        if (trigger === 'focus') {\n          callFuncWithDelay({\n            delay: appearDelay,\n            callback: () => onVisibleChange(true, { trigger: 'trigger-element-focus' }),\n          });\n        }\n        triggerNode.props.onFocus?.(...args);\n      },\n      onBlur: (...args: any) => {\n        if (trigger === 'focus') {\n          callFuncWithDelay({\n            delay: appearDelay,\n            callback: () => onVisibleChange(false, { trigger: 'trigger-element-blur' }),\n          });\n        }\n        triggerNode.props.onBlur?.(...args);\n      },\n      onContextMenu: (e: MouseEvent) => {\n        if (trigger === 'context-menu') {\n          e.preventDefault();\n          callFuncWithDelay({\n            delay: appearDelay,\n            callback: () => onVisibleChange(true, { e, trigger: 'context-menu' }),\n          });\n        }\n        triggerNode.props.onContextMenu?.(e);\n      },\n      onKeyDown: (e: KeyboardEvent) => {\n        if (e?.key === ESC_KEY) {\n          callFuncWithDelay({\n            delay: exitDelay,\n            callback: () => onVisibleChange(false, { e, trigger: 'keydown-esc' }),\n          });\n        }\n        triggerNode.props.onKeyDown?.(e);\n      },\n    };\n\n    if (supportRef(triggerNode)) {\n      triggerProps.ref = composeRefs(triggerRef, getNodeRef(triggerNode as any));\n    } else {\n      // 标记 trigger 元素\n      triggerProps['data-popup'] = triggerDataKey.current;\n    }\n\n    return triggerProps;\n  }\n\n  // 整理 trigger 元素\n  function getTriggerNode(children: React.ReactNode) {\n    const triggerNode =\n      isValidElement(children) && !isFragment(children) ? children : <span className=\"t-trigger\">{children}</span>;\n\n    return React.cloneElement(triggerNode, getTriggerProps(triggerNode));\n  }\n\n  // ref 透传失败时使用 dom 查找\n  const getTriggerDom = useCallback(() => {\n    if (typeof document === 'undefined') return {};\n    return document.querySelector(`[data-popup=\"${triggerDataKey.current}\"]`);\n  }, []);\n\n  return {\n    getTriggerNode,\n    getPopupProps,\n    getTriggerDom,\n  };\n}\n"],"names":["ESC_KEY","useTrigger","_ref","content","disabled","trigger","visible","onVisibleChange","triggerRef","delay","hasPopupMouseDown","useRef","mouseDownTimer","visibleTimer","triggerDataKey","Math","random","toFixed","leaveFlag","shouldToggle","useMemo","_useMemo","Array","isArray","_useMemo2","_slicedToArray","_useMemo2$","appearDelay","_useMemo2$2","exitDelay","callFuncWithDelay","_ref2","callback","clearTimeout","current","setTimeout","useEffect","handleDocumentClick","e","_getRefDom","_getRefDom$contains","getRefDom","contains","call","target","on","document","off","getPopupProps","onMouseEnter","onMouseLeave","onMouseDown","window","onTouchEnd","getTriggerProps","triggerNode","triggerProps","className","classNames","props","_triggerNode$props$on","_triggerNode$props","onClick","_triggerNode$props$on2","_triggerNode$props2","onTouchStart","_triggerNode$props$on3","_triggerNode$props3","_triggerNode$props$on4","_triggerNode$props4","_triggerNode$props$on5","_triggerNode$props5","onFocus","_triggerNode$props$on6","_triggerNode$props6","_len","arguments","length","args","_key","apply","concat","onBlur","_triggerNode$props$on7","_triggerNode$props7","_len2","_key2","onContextMenu","_triggerNode$props$on8","_triggerNode$props8","preventDefault","onKeyDown","_triggerNode$props$on9","_triggerNode$props9","key","supportRef","ref","composeRefs","getNodeRef","getTriggerNode","children","isValidElement","isFragment","React","createElement","cloneElement","getTriggerDom","useCallback","querySelector"],"mappings":"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"}