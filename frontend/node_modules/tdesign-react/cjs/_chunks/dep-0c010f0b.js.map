{"version":3,"file":"dep-0c010f0b.js","sources":["../../../components/radio/RadioGroup.tsx","../../../components/radio/Radio.tsx"],"sourcesContent":["import React, { CSSProperties, ReactNode, useEffect, useRef, useState } from 'react';\nimport classNames from 'classnames';\nimport observe from '@tdesign/common-js/utils/observe';\nimport useConfig from '../hooks/useConfig';\nimport { TdRadioGroupProps } from './type';\nimport useControlled from '../hooks/useControlled';\nimport useCommonClassName from '../hooks/useCommonClassName';\nimport { StyledProps } from '../common';\nimport { CheckContext, CheckContextValue } from '../common/Check';\nimport Radio from './Radio';\nimport { radioGroupDefaultProps } from './defaultProps';\nimport useDefaultProps from '../hooks/useDefaultProps';\nimport useKeyboard from './useKeyboard';\n\n/**\n * RadioGroup 组件所接收的属性\n */\nexport interface RadioGroupProps extends TdRadioGroupProps, StyledProps {\n  children?: ReactNode;\n}\n\n/**\n * 单选选项组，里面可以嵌套 <Radio />\n */\nconst RadioGroup: React.FC<RadioGroupProps> = (originalProps) => {\n  const { classPrefix } = useConfig();\n\n  const props = useDefaultProps<RadioGroupProps>(originalProps, radioGroupDefaultProps);\n\n  const { disabled, readonly, children, onChange, size, variant, options = [], className, style, theme } = props;\n\n  const [internalValue, setInternalValue] = useControlled(props, 'value', onChange);\n  const [barStyle, setBarStyle] = useState<Partial<CSSProperties> | null>(null);\n  const radioGroupRef = useRef<HTMLDivElement>(null);\n  const observerRef = useRef<IntersectionObserver>(null);\n\n  useKeyboard(radioGroupRef, setInternalValue);\n\n  const checkedRadioCls = `.${classPrefix}-radio-button.${classPrefix}-is-checked`;\n  const { SIZE: sizeMap } = useCommonClassName();\n\n  const context: CheckContextValue = {\n    inject: (checkProps) => {\n      // 如果已经受控，则不注入\n      if (typeof checkProps.checked !== 'undefined') {\n        return checkProps;\n      }\n\n      const { value: checkValue } = checkProps;\n\n      return {\n        ...checkProps,\n        name: props.name,\n        // 有一个允许取消，就可以取消选中\n        allowUncheck: checkProps.allowUncheck || props.allowUncheck,\n        checked: internalValue === checkProps.value,\n        disabled: checkProps.disabled || disabled,\n        readonly: checkProps.readonly || readonly,\n        onChange(checked, { e }) {\n          if (typeof checkProps.onChange === 'function') {\n            checkProps.onChange(checked, { e });\n          }\n          setInternalValue(checked ? checkValue : undefined, { e, name: props.name });\n        },\n      };\n    },\n  };\n\n  const calcBarStyle = () => {\n    if (!variant.includes('filled')) return;\n\n    const checkedRadio = radioGroupRef.current.querySelector?.(checkedRadioCls) as HTMLElement;\n    if (!checkedRadio) return;\n\n    const { offsetWidth, offsetHeight, offsetLeft, offsetTop } = checkedRadio;\n    setBarStyle({\n      width: `${offsetWidth}px`,\n      height: `${offsetHeight}px`,\n      left: `${offsetLeft}px`,\n      top: `${offsetTop}px`,\n    });\n  };\n\n  useEffect(() => {\n    calcBarStyle();\n\n    if (!radioGroupRef.current) return;\n\n    const observer = observe(radioGroupRef.current, null, calcBarStyle, 0);\n    observerRef.current = observer;\n\n    return () => {\n      observerRef.current?.disconnect();\n      observerRef.current = null;\n    };\n  }, [radioGroupRef.current, internalValue]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  const renderBlock = () => {\n    if (!variant.includes('filled')) {\n      return null;\n    }\n    return <div style={barStyle} className={`${classPrefix}-radio-group__bg-block`}></div>;\n  };\n\n  const renderOptions = () => {\n    const Comp = theme === 'button' ? Radio.Button : Radio;\n    return options.map((item, index) => {\n      let label: ReactNode;\n      let value: string | number | boolean;\n      let disabled: boolean | undefined;\n      if (typeof item === 'string' || typeof item === 'number') {\n        label = item;\n        value = item;\n      } else {\n        label = item.label;\n        value = item.value;\n        disabled = item.disabled;\n      }\n      return (\n        <Comp value={value} key={index} disabled={disabled}>\n          {label}\n        </Comp>\n      );\n    });\n  };\n\n  return (\n    <CheckContext.Provider value={context}>\n      <div\n        ref={radioGroupRef}\n        style={style}\n        className={classNames(`${classPrefix}-radio-group`, sizeMap[size], className, {\n          [`${classPrefix}-radio-group__outline`]: variant === 'outline',\n          [`${classPrefix}-radio-group--filled`]: variant.includes('filled'),\n          [`${classPrefix}-radio-group--primary-filled`]: variant === 'primary-filled',\n        })}\n      >\n        {children || renderOptions()}\n        {renderBlock()}\n      </div>\n    </CheckContext.Provider>\n  );\n};\n\nRadioGroup.displayName = 'RadioGroup';\n\nexport default RadioGroup;\n","import React, { Ref, forwardRef } from 'react';\nimport forwardRefWithStatics from '../_util/forwardRefWithStatics';\nimport Check, { CheckProps } from '../common/Check';\nimport RadioGroup from './RadioGroup';\nimport { radioDefaultProps } from './defaultProps';\nimport useDefaultProps from '../hooks/useDefaultProps';\n\nexport type RadioProps = Omit<CheckProps, 'type'>;\n\nconst Radio = forwardRefWithStatics(\n  (props: RadioProps, ref: Ref<HTMLLabelElement>) => (\n    <Check ref={ref} type=\"radio\" {...useDefaultProps<RadioProps>(props, radioDefaultProps)} />\n  ),\n  {\n    Group: RadioGroup,\n    Button: forwardRef<HTMLLabelElement, RadioProps>((props, ref) => (\n      <Check ref={ref} type=\"radio-button\" {...useDefaultProps<RadioProps>(props, radioDefaultProps)} />\n    )),\n  },\n);\n\nRadio.displayName = 'Radio';\n\nexport default Radio;\n"],"names":["RadioGroup","originalProps","_useConfig","useConfig","classPrefix","props","useDefaultProps","radioGroupDefaultProps","disabled","readonly","children","onChange","size","variant","_props$options","options","className","style","theme","_useControlled","useControlled","_useControlled2","_slicedToArray","internalValue","setInternalValue","_useState","useState","_useState2","barStyle","setBarStyle","radioGroupRef","useRef","observerRef","useKeyboard","checkedRadioCls","concat","_useCommonClassName","useCommonClassName","sizeMap","SIZE","context","inject","checkProps","checked","checkValue","value","_objectSpread","name","allowUncheck","_ref","e","calcBarStyle","_radioGroupRef$curren","_radioGroupRef$curren2","includes","checkedRadio","current","querySelector","call","offsetWidth","offsetHeight","offsetLeft","offsetTop","width","height","left","top","useEffect","observer","observe","_observerRef$current","disconnect","renderBlock","React","createElement","renderOptions","Comp","Radio","Button","map","item","index","label","key","CheckContext","Provider","ref","classNames","_defineProperty","displayName","forwardRefWithStatics","Check","type","radioDefaultProps","Group","forwardRef"],"mappings":"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"}