{"version":3,"file":"CheckTag.js","sources":["../../../components/tag/CheckTag.tsx"],"sourcesContent":["import React, { forwardRef, MouseEvent, useMemo, FocusEvent } from 'react';\nimport classNames from 'classnames';\nimport { ENTER_REG, SPACE_REG } from '@tdesign/common-js/common';\nimport useControlled from '../hooks/useControlled';\nimport useConfig from '../hooks/useConfig';\nimport { TdCheckTagProps, TdTagProps } from './type';\nimport { StyledProps } from '../common';\nimport noop from '../_util/noop';\nimport { checkTagDefaultProps } from './defaultProps';\nimport Tag from './Tag';\nimport useDefaultProps from '../hooks/useDefaultProps';\n\n/**\n * CheckTag 组件支持的属性\n */\nexport interface CheckTagProps extends TdCheckTagProps, StyledProps {\n  /**\n   * 标签内容\n   */\n  children?: React.ReactNode;\n}\n\nconst CheckTag = forwardRef<HTMLDivElement, CheckTagProps>((originalProps, ref) => {\n  const props = useDefaultProps<CheckTagProps>(originalProps, checkTagDefaultProps);\n  const {\n    value,\n    content,\n    onClick = noop,\n    disabled,\n    children,\n    size,\n    checkedProps,\n    uncheckedProps,\n    onChange,\n    className,\n    ...tagOtherProps\n  } = props;\n  const [innerChecked, setInnerChecked] = useControlled(props, 'checked', onChange);\n\n  const { classPrefix } = useConfig();\n  const tagClassPrefix = `${classPrefix}-tag`;\n\n  const tagClass = useMemo(\n    () => [\n      `${tagClassPrefix}`,\n      `${tagClassPrefix}--check`,\n      {\n        [`${tagClassPrefix}--checked`]: innerChecked,\n        [`${tagClassPrefix}--disabled`]: disabled,\n        [`${classPrefix}-size-s`]: size === 'small',\n        [`${classPrefix}-size-l`]: size === 'large',\n      },\n      className,\n    ],\n    [innerChecked, disabled, classPrefix, tagClassPrefix, size, className],\n  );\n\n  const checkTagProps = useMemo(() => {\n    const tmpCheckedProps: TdTagProps = { theme: 'primary', ...checkedProps };\n    const tmpUncheckedProps: TdTagProps = { ...uncheckedProps };\n    return innerChecked ? tmpCheckedProps : tmpUncheckedProps;\n  }, [innerChecked, checkedProps, uncheckedProps]);\n\n  const handleClick = ({ e }: { e: MouseEvent<HTMLDivElement> }) => {\n    if (!disabled) {\n      onClick?.({ e });\n      setInnerChecked(!innerChecked, { e, value });\n    }\n  };\n\n  const keyboardEventListener = (e) => {\n    const code = e.code || e.key?.trim();\n    const isCheckedCode = SPACE_REG.test(code) || ENTER_REG.test(code);\n    if (isCheckedCode) {\n      e.preventDefault();\n      setInnerChecked(!innerChecked, { e, value });\n    }\n  };\n\n  const onCheckboxFocus = (e: FocusEvent<HTMLDivElement>) => {\n    e.currentTarget.addEventListener('keydown', keyboardEventListener);\n  };\n\n  const onCheckboxBlur = (e: FocusEvent<HTMLDivElement>) => {\n    e.currentTarget.removeEventListener('keydown', keyboardEventListener);\n  };\n\n  return (\n    <Tag\n      ref={ref}\n      className={classNames(tagClass)}\n      disabled={props.disabled}\n      tabIndex={props.disabled ? undefined : 0}\n      onFocus={onCheckboxFocus}\n      onBlur={onCheckboxBlur}\n      {...checkTagProps}\n      onClick={handleClick}\n      {...tagOtherProps}\n    >\n      {content || children}\n    </Tag>\n  );\n});\n\nCheckTag.displayName = 'CheckTag';\n\nexport default CheckTag;\n"],"names":["CheckTag","forwardRef","originalProps","ref","props","useDefaultProps","checkTagDefaultProps","value","content","_props$onClick","onClick","noop","disabled","children","size","checkedProps","uncheckedProps","onChange","className","tagOtherProps","_objectWithoutProperties","_excluded","_useControlled","useControlled","_useControlled2","_slicedToArray","innerChecked","setInnerChecked","_useConfig","useConfig","classPrefix","tagClassPrefix","tagClass","useMemo","concat","_defineProperty","checkTagProps","tmpCheckedProps","_objectSpread","theme","tmpUncheckedProps","handleClick","_ref2","e","keyboardEventListener","_e$key","code","key","trim","isCheckedCode","SPACE_REG","test","ENTER_REG","preventDefault","onCheckboxFocus","currentTarget","addEventListener","onCheckboxBlur","removeEventListener","React","createElement","Tag","classNames","tabIndex","onFocus","onBlur","displayName"],"mappings":"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"}