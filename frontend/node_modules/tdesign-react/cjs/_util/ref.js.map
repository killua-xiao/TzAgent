{"version":3,"file":"ref.js","sources":["../../../components/_util/ref.ts"],"sourcesContent":["// Source from:\n// https://github.com/react-component/util/blob/master/src/ref.ts\n\nimport { isValidElement } from 'react';\nimport { ForwardRef, isMemo } from 'react-is';\nimport isFragment from './isFragment';\n\n// 判断是否支持 ref 透传\nexport const supportRef = (nodeOrComponent: any): boolean => {\n  if (!nodeOrComponent) {\n    return false;\n  }\n\n  // React 19 no need `forwardRef` anymore. So just pass if is a React element.\n  // eslint-disable-next-line no-prototype-builtins\n  if (isReactElement(nodeOrComponent) && (nodeOrComponent as any).props.propertyIsEnumerable('ref')) {\n    return true;\n  }\n\n  const type = isMemo(nodeOrComponent) ? nodeOrComponent.type.type : nodeOrComponent.type;\n\n  // Function component node\n  if (typeof type === 'function' && !type.prototype?.render && type.$$typeof !== ForwardRef) {\n    return false;\n  }\n\n  // Class component\n  if (\n    typeof nodeOrComponent === 'function' &&\n    !nodeOrComponent.prototype?.render &&\n    nodeOrComponent.$$typeof !== ForwardRef\n  ) {\n    return false;\n  }\n  return true;\n};\n\n// 获取 ref 中的 dom 元素\nexport function getRefDom(domRef: React.RefObject<any>) {\n  if (domRef.current && typeof domRef.current === 'object' && 'currentElement' in domRef.current) {\n    return domRef.current.currentElement;\n  }\n  return domRef.current;\n}\n\ninterface RefAttributes<T> extends React.Attributes {\n  ref: React.Ref<T>;\n}\n\nfunction isReactElement(node: React.ReactNode) {\n  return isValidElement(node) && !isFragment(node);\n}\n\nexport const supportNodeRef = <T = any>(node: React.ReactNode): node is React.ReactElement & RefAttributes<T> =>\n  isReactElement(node) && supportRef(node);\n\n/**\n * In React 19. `ref` is not a property from node.\n * But a property from `props.ref`.\n * To check if `props.ref` exist or fallback to `ref`.\n */\nexport const getNodeRef: <T = any>(node: React.ReactNode) => React.Ref<T> | null = (node) => {\n  if (node && isReactElement(node)) {\n    const ele = node as any;\n\n    // Source from:\n    // https://github.com/mui/material-ui/blob/master/packages/mui-utils/src/getReactNodeRef/getReactNodeRef.ts\n    // eslint-disable-next-line no-prototype-builtins\n    return ele.props.propertyIsEnumerable('ref') ? ele.props.ref : ele.ref;\n  }\n  return null;\n};\n"],"names":["supportRef","nodeOrComponent","_type$prototype","_nodeOrComponent$prot","isReactElement","props","propertyIsEnumerable","type","isMemo","prototype","render","$$typeof","ForwardRef","getRefDom","domRef","current","_typeof","currentElement","node","isValidElement","isFragment","supportNodeRef","getNodeRef","ele","ref"],"mappings":";;;;;;;;;;;;;;;IAQaA,UAAA,GAAa,SAAbA,UAAAA,CAAcC,eAAkC,EAAA;EAAA,IAAAC,eAAA,EAAAC,qBAAA,CAAA;EAC3D,IAAI,CAACF,eAAiB,EAAA;AACb,IAAA,OAAA,KAAA,CAAA;AACT,GAAA;AAIA,EAAA,IAAIG,eAAeH,eAAe,CAAA,IAAMA,gBAAwBI,KAAM,CAAAC,oBAAA,CAAqB,KAAK,CAAG,EAAA;AAC1F,IAAA,OAAA,IAAA,CAAA;AACT,GAAA;AAEA,EAAA,IAAMC,OAAOC,iBAAO,CAAAP,eAAe,IAAIA,eAAgB,CAAAM,IAAA,CAAKA,OAAON,eAAgB,CAAAM,IAAA,CAAA;EAG/E,IAAA,OAAOA,SAAS,UAAc,IAAA,EAAAL,CAAAA,eAAA,GAACK,KAAKE,SAAW,cAAAP,eAAA,KAAA,KAAA,CAAA,IAAhBA,eAAA,CAAgBQ,MAAA,CAAA,IAAUH,IAAK,CAAAI,QAAA,KAAaC,qBAAY,EAAA;AAClF,IAAA,OAAA,KAAA,CAAA;AACT,GAAA;EAIE,IAAA,OAAOX,oBAAoB,UAC3B,IAAA,EAAAE,CAAAA,qBAAA,GAACF,gBAAgBQ,SAAW,cAAAN,qBAAA,KAAA,KAAA,CAAA,IAA3BA,qBAAA,CAA2BO,MAAA,CAAA,IAC5BT,eAAgB,CAAAU,QAAA,KAAaC,qBAC7B,EAAA;AACO,IAAA,OAAA,KAAA,CAAA;AACT,GAAA;AACO,EAAA,OAAA,IAAA,CAAA;AACT,EAAA;AAGO,SAASC,UAAUC,MAA8B,EAAA;AAClD,EAAA,IAAAA,MAAA,CAAOC,WAAWC,eAAA,CAAOF,MAAA,CAAOC,aAAY,QAAY,IAAA,gBAAA,IAAoBD,OAAOC,OAAS,EAAA;AAC9F,IAAA,OAAOD,OAAOC,OAAQ,CAAAE,cAAA,CAAA;AACxB,GAAA;EACA,OAAOH,MAAO,CAAAC,OAAA,CAAA;AAChB,CAAA;AAMA,SAASX,eAAec,IAAuB,EAAA;EAC7C,oBAAOC,oBAAe,CAAAD,IAAI,CAAK,IAAA,CAACE,4BAAWF,IAAI,CAAA,CAAA;AACjD,CAAA;IAEaG,iBAAiB,SAAjBA,eAA2BH,IAAA,EAAA;EAAA,OACtCd,eAAec,IAAI,CAAA,IAAKlB,WAAWkB,IAAI,CAAA,CAAA;AAAA,EAAA;IAO5BI,UAAA,GAAsE,SAAtEA,UAAAA,CAAuEJ,IAAS,EAAA;AACvF,EAAA,IAAAA,IAAA,IAAQd,cAAe,CAAAc,IAAI,CAAG,EAAA;IAChC,IAAMK,GAAM,GAAAL,IAAA,CAAA;AAKL,IAAA,OAAAK,GAAA,CAAIlB,MAAMC,oBAAqB,CAAA,KAAK,IAAIiB,GAAI,CAAAlB,KAAA,CAAMmB,MAAMD,GAAI,CAAAC,GAAA,CAAA;AACrE,GAAA;AACO,EAAA,OAAA,IAAA,CAAA;AACT;;;;;;;"}